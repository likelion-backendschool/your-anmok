<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <title>ë‹¹ì‹ ì˜ ì•ˆëª© ë©”ì¸í˜ì´ì§€</title>

    <style>
        #my_location_button{position: absolute;bottom:-150px;right:0;z-index: 100;}
        #searchMapFormByCategoryId{position: absolute;bottom:-100px;right:0;z-index: 100;}
        #makeMyCategory{position: absolute;bottom:-200px;right:0;z-index: 100;}
        /*ìŠ¬ë¼ì´ë“œ ë²„íŠ¼ ê´€ë ¨ CSS*/
        #hamburger_button {
            cursor:pointer;
            position:absolute;
            top:0px;
            left:0px;
            z-index: 200;
        }

        .left_sub_menu {
            position: fixed;
            top: 50px;
            width: 300px;
            z-index: 10;
            left: 0px;
            background: white;
            border-right: 1px solid rgba(0, 0, 0, 0.07);
            bottom: 50px;
            height: 100%;
            margin-bottom: -70px;
            margin-top: 0px;
            padding-bottom: 0px;
            box-shadow: 0 0px 24px 0 rgb(0 0 0 / 6%), 0 1px 0px 0 rgb(0 0 0 / 2%);
            color: black;
        }

        .sub_menu {
            margin-top: 50px;
        }

        .left_sub_menu>.sub_menu li:hover {
            color: #ff5858;
            background-color: #e1e1e1;
        }

        .left_sub_menu>.sub_menu li {
            color: #333;
            font-size: 17px;
            font-weight: 600;
            padding: 20px 0px 8px 14px;
            border-bottom: 1px solid #e1e1e1;
        }

        .sub_menu>div {
            padding-bottom: 4px;
            border-bottom: 3px solid #797979;
            margin-top: 30px;
            font-size: 21px;
            font-weight: 600;
            color: #333;
            margin-left: 10px;
            margin-right: 10px;
            font-family: 'NotoKrB';
            line-height: 35px;
        }

        .sub_menu .fas {
            color: #ff5858;
            font-size: 20px;
            line-height: 20px;
            float: right;
            margin-right: 20px;
        }

        .sub_menu>.big_menu>.small_menu li {
            color: #333;
            font-size: 14px;
            font-weight: 600;
            border-bottom: 0px solid #e1e1e1;
            margin-left: 14px;
            padding-top: 8px;
        }

        .big_menu {
            cursor: pointer;
        }

        ul {
            padding-inline-start: 0px;
        }

        a {
            color: #797979;
            text-decoration: none;
            background-color: transparent;
            display: block;
            cursor: pointer;
        }

        ul {
            list-style: none;
        }

        ol,
        ul {
            margin-top: 0;
            margin-bottom: 10px;
        }

        .has_sub {
            width: 100%;
        }

        .overlay {
            position: fixed;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
        }

        .hide_sidemenu {
            display: none;
        }

        /* */
        #my_location_button{position: absolute;bottom:0;right:0;z-index: 100}
        #my_location_button1{position: absolute;bottom:0;right:0;z-index: 100}

        .map_wrap, .map_wrap * {margin:0;padding:0;font-family:'Malgun Gothic',dotum,'ë‹ì›€',sans-serif;font-size:12px;}
        .map_wrap a, .map_wrap a:hover, .map_wrap a:active{color:#000;text-decoration: none;}
        .map_wrap {position:relative;width:100%;height:500px;}
        #search_wrap {position:absolute;top:0;right:0;bottom:0;width:250px;margin:10px 0 30px 10px;padding:5px;overflow-y:auto;background:rgba(255, 255, 255, 0.7);z-index: 1;font-size:12px;border-radius: 10px;}
        .bg_white {background:#fff;}
        #search_wrap hr {display: block; height: 1px;border: 0; border-top: 2px solid #5F5F5F;margin:3px 0;}
        #search_wrap .option{text-align: center;}
        #search_wrap .option p {margin:10px 0;}
        #search_wrap .option button {margin-left:5px;}
    </style>

    <!--ì œì´ì¿¼ë¦¬-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <!--bxSlider JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bxslider/4.2.15/jquery.bxslider.min.js"></script>
    <!--bxSlider CSS-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bxslider/4.2.15/jquery.bxslider.min.css" rel="stylesheet" />
    <!--í…Œì¼ìœˆë“œ-->
    <script src="https://cdn.tailwindcss.com"></script>
    <!--ë¶€íŠ¸ìŠ¤íŠ¸ë© CSS-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <!--ë¶€íŠ¸ìŠ¤íŠ¸ë© JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <!--ë°ì´ì§€UI-->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@2.20.0/dist/full.css" rel="stylesheet" type="text/css" />
    <!--í°íŠ¸ì–´ì¸-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css"/>
    <!--ì¹´ì¹´ì˜¤-->
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=0faeb3dc4793a50259747d85fd7d9a89&libraries=services"></script>
    <!--CSSíŒŒì¼-->
    <link rel="stylesheet" type="text/css" href="/css/popup/popup.css">
</head>

<body>
<div class="map_wrap" style="position: relative;">
    <div id="map" class="w-screen h-screen" >

    </div>


    <button id="my_location_button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded fas fa-crosshairs" onclick="getCurrentPosBtn()">
    </button>
    <form th:action="@{/searchMap}" id="searchMapFormByCategoryId">
        <input type="text" name="categoryId" th:value="${categoryId}" id="searchMapButtonByCategoryId" size="15" style="display: none;" />
        <button class="btn btn-primary btn-lg" type="submit">ê²€ìƒ‰í•˜ê¸°</button>
    </form>
    <button id="makeMyCategory" class="btn btn-primary btn-lg" onclick="location.href='/category/add'">ë‚˜ë§Œì˜ ì¹´í…Œê³ ë¦¬ ë§Œë“¤ê¸°</button>

    <div id="menu">
        <div class="close"></div>

        <a id="hamburger_button" class="fas fa-bars fa-3x"></a>

        <div class="left_sub_menu">
            <div class="sub_menu">
                <div class="d-flex flex-row justify-between">
                    <a class="h3" href="/">ë‹¹ì‹ ì˜ ì•ˆëª© ğŸ‘€</a>
<!--                    <div>-->
                        <form action="/auth/loginProc" method="post">
                            <a sec:authorize="isAnonymous()" href="https://kauth.kakao.com/oauth/authorize?client_id=84bb53ddc4e742b0c6aa6c06a6372dbc&redirect_uri=http://localhost:8080/auth/kakao/callback&response_type=code"><img width="70px" height="50px" src="/image/KakaoLoginBtn.jpg"></a>
                            <div class="btn btn-warning" sec:authorize="isAuthenticated()"><a class="text-white text-decoration-none" href="/logout">ë¡œê·¸ì•„ì›ƒ</a></div>
                        </form>
<!--                    </div>-->
                </div>

                <ul class="big_menu">
                    <li><a href="/category/home">ì¹´í…Œê³ ë¦¬</a></li>
<!--                    <ul class="small_menu">-->
<!--                        <li><a href="#">ì†Œë©”ë‰´1-1</a></li>-->
<!--                        <li><a href="#">ì†Œë©”ë‰´1-2</a></li>-->
<!--                        <li><a href="">ì†Œë©”ë‰´1-3</a></li>-->
<!--                        <li><a href="#">ì†Œë©”ë‰´1-4</a></li>-->
<!--                    </ul>-->
                </ul>
                <ul class="big_menu">
                    <li><a href="/gathering/list">ë²ˆê°œëª¨ì„</a></li>
<!--                    <ul class="small_menu">-->
<!--                        <li><a href="#">ì†Œë©”ë‰´2-1</a></li>-->
<!--                        <li><a href="#"></a>ì†Œë©”ë‰´2-2</a></li>-->
<!--                    </ul>-->
                </ul>
                <ul class="big_menu">
                    <li><a href="/mypage">ë§ˆì´í˜ì´ì§€</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=0faeb3dc4793a50259747d85fd7d9a89&libraries=services&autoload=false"></script>


<script th:inline="javascript">
    // ì»¨íŠ¸ë¡¤ëŸ¬ì— ìˆëŠ” ê°’ì„ th:inline="javascript"ë¥¼ í†µí•´ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ê°€ì ¸ì˜¤ê¸° ë°‘ì— ìˆëŠ” ì£¼ì„ì€ ê¼­ ë‹¬ì•„ì¤˜ì•¼ í•œë‹¤.

    /*<![CDATA[*/

    let allPlaceList = [[${allPlaceList}]];
    console.log(allPlaceList);

    /*]]>*/

</script>

<script>
    let container = document.getElementById("map");
    let options = {
        // ì¼ë‹¨ í™ëŒ€ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì¡ëŠ” ë§µ ìƒì„±
        center: new kakao.maps.LatLng(37.511133583298516, 126.97978788338133),
        // // ì¼ë‹¨ ì ë‹¹í•œ ì§€ë„ì˜ ë†’ì´ ë ˆë²¨ 7 ì •ë„ë¡œ ìˆ˜ì •
        level: 7
    };

    let map = new kakao.maps.Map(container, options);

    $(function () {
        $(".left_sub_menu").hide();
        $("#hamburger_button").click(function () {
            $(".left_sub_menu").fadeToggle(300);
        });
        // // ì™¼ìª½ë©”ë‰´ ë“œë¡­ë‹¤ìš´
        // $(".sub_menu ul.small_menu").hide();
        // $(".sub_menu ul.big_menu").click(function () {
        //     $("ul", this).slideToggle(300);
        // });
        // ì™¸ë¶€ í´ë¦­ ì‹œ ì¢Œì¸¡ ì‚¬ì´ë“œ ë©”ë‰´ ìˆ¨ê¸°ê¸°
        $('#map').on('click', function () {
            $('.left_sub_menu').fadeOut();
            $('.hide_sidemenu').fadeIn();
        });
    });

    // ì£¼ì†Œ - ì¢Œí‘œ ë³€í™˜ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
    let geocoder = new kakao.maps.services.Geocoder();

    function closePopup() {
        document.getElementById("detail_popup_layer").style.display = "none"
    }

    function slider() {
        var slide = $('.bxslider').bxSlider({
            mode: "horizontal",    // ê°€ë¡œ ìˆ˜í‰ìœ¼ë¡œ ìŠ¬ë¼ì´ë“œëœë‹¤.
            speed: 200,        // ì´ë™ ì†ë„ë¥¼ ì„¤ì •í•œë‹¤.
            pager: false,    // í˜„ì¬ ìœ„ì¹˜ í˜ì´ì§€ í‘œì‹œ ì—¬ë¶€ë¥¼ ì„¤ì •í•œë‹¤.
            moveSlides: 2,    // ìŠ¬ë¼ì´ë“œ ì´ë™ ì‹œ ê°œìˆ˜ë¥¼ ì„¤ì •í•œë‹¤.
            slideWidth: 280,    // ìŠ¬ë¼ì´ë“œ ë„ˆë¹„ë¥¼ ì„¤ì •í•œë‹¤.
            minSlides: 4,    // ìµœì†Œ ë…¸ì¶œ ê°œìˆ˜ë¥¼ ì„¤ì •í•œë‹¤.
            maxSlides: 4,    // ìµœëŒ€ ë…¸ì¶œ ê°œìˆ˜ë¥¼ ì„¤ì •í•œë‹¤.
            slideMargin: 28, // ìŠ¬ë¼ì´ë“œ ê°„ì˜ ê°„ê²©ì„ ì„¤ì •í•œë‹¤.
            auto: true,         // ìë™ìœ¼ë¡œ íë¥¼ì§€ ì—¬ë¶€ë¥¼ ì„¤ì •í•œë‹¤.
            autoHover: true, // ë§ˆìš°ìŠ¤ì˜¤ë²„ ì‹œ ì •ì§€í• ì§€ë¥¼ ì„¤ì •í•œë‹¤.
            controls: true    // ì´ì „ ë²„íŠ¼, ë‹¤ìŒ ë²„íŠ¼ ë…¸ì¶œ ì—¬ë¶€ë¥¼ ì„¤ì •í•œë‹¤.
        });

        slide.reloadSlider();
    };

    // ì£¼ì†Œë¡œ ì¢Œí‘œë¥¼ ê²€ìƒ‰í•œë‹¤. í…Œì´ë¸” ì£¼ì†Œ -> ì¢Œí‘œ -> ì§€ë„ì— ë§ˆì»¤ë¡œ í‘œì‹œ
    for (let i =0;i<allPlaceList.length;i++) {

        geocoder.addressSearch(allPlaceList[i].address, function (result, status) {
            let coords = new kakao.maps.LatLng(result[0].y, result[0].x);

            // ê²°ê³¼ê°’ìœ¼ë¡œ ë°›ì€ ìœ„ì¹˜ë¥¼ ë§ˆì»¤ë¡œ í‘œì‹œ
            let marker = new kakao.maps.Marker({
                map: map,
                position: coords
            });



            kakao.maps.event.addListener(marker, 'click', function (){
               // location.href="/place/"+allPlaceList[i].id+"#load";

                $.ajax({
                    url : "/place/"+allPlaceList[i].id,
                    type : "GET",
                    async: false,
                    success : function(data){
                        console.log(data);
                        console.log(data.place.name);
                        $('p[id=place_info_placeName]').text(data.place.name);
                        $('p[id=place_info_placeAddress]').text(data.place.address);


                        let categorySize = data.categoryList.length;
                        let gatheringSize = data.placeGatheringDtos.length;
                        let imageSize = data.placeImages.length;
                        let starSize = data.place.star;
                        let emptyStarSize = 5-data.place.star;

                        console.log("ì¹´í…Œê³ ë¦¬ ì‚¬ì´ì¦ˆëŠ”"+categorySize);
                        console.log("ì¹´í…Œê³ ë¦¬ ì´ë¦„:"+data.categoryList[0].tagName);
                        function categoryDOM(categoryList){
                            let tr = '';

                            tr+=`<tr>`;
                            for (let i=0;i<categorySize;i++) {
                                tr += `    <button class="categoryNameBtn" onclick="location.href='/?categoryId=${categoryList[i].id}'">${categoryList[i].tagName}</button>`
                            }

                            tr+=`</tr>`;
                            console.log(tr);
                            document.getElementById("place_info_categoryList").innerHTML=tr;
                        }

                        function gatheringDOM(gatheringList){
                            let tr = '';

                            tr+=`<tr>`;
                            for (let i=0;i<gatheringSize;i++){
                                tr +=`    <button class="gathingTitleBtn" onclick="location.href='/gathering/${gatheringList[i].id}'">${gatheringList[i].title}</button>`
                            }
                            tr+=`</tr>`;
                            console.log(tr);
                            document.getElementById("place_info_gatheringList").innerHTML=tr;
                        }

                        function starDOM(star){
                            let tr = '';

                            tr+=`<tr>`;
                            for (let i=0;i<starSize;i++){
                                tr +=`    <img src="/images/star.png" class="star">`
                            }
                            tr+=`</tr>`;

                            tr+=`<tr>`;
                            for (let i=0;i<emptyStarSize;i++){
                                tr +=`    <img src="/images/empty_star.png" class="star">`
                            }
                            tr+=`</tr>`;
                            console.log(tr);
                            document.getElementById("star_box").innerHTML=tr;
                        }

                        function imageDOM(placeImages){
                            let ul='';
                            ul+=`<ul class="bxslider">`;
                            ul+=`    <tr>`;
                            for (let i=0;i<imageSize;i++){
                                ul+=`        <li><img class="usr_img" src="/placeimg/${placeImages[i].filePath}"></li>`
                            }
                            ul+=`    </tr>`;
                            ul+=`</ul>`;
                            document.getElementById("place_info_imageList").innerHTML=ul;
                        }

                        categoryDOM(data.categoryList);
                        gatheringDOM(data.placeGatheringDtos);
                        imageDOM(data.placeImages);
                        starDOM(data.place.star);

                        document.getElementById("detail_popup_layer").style.display='block'
                        slider();
                    }
                });

            });


            let infowindow = new kakao.maps.InfoWindow({
                content: '<div style="width:150px;text-align:center;padding:6px 0;">' + allPlaceList[i].name + '</div>'
            });



            infowindow.open(map, marker);

            // kakao.maps.event.addEventListener(marker, 'mouseout', function () {
            //     // ë§ˆì»¤ì— ë§ˆìš°ìŠ¤ì•„ì›ƒ ì´ë²¤íŠ¸ ë°œìƒí•˜ë©´ ì¸í¬ìœˆë„ìš° ì œê±°
            //     infowindow.close();
            //
            // });

        })
    }

        function locationLoadSuccess(pos) {
            let currentPos = new kakao.maps.LatLng(
                pos.coords.latitude,
                pos.coords.longitude
            );

            map.panTo(currentPos);
            map.setLevel(4);
        }

        function getCurrentPosBtn() {
            navigator.geolocation.getCurrentPosition(locationLoadSuccess, null);
            console.log("í˜„ì¬ìœ„ì¹˜ ë²„íŠ¼ í´ë¦­ë¨");
        }

        // ë§ˆì»¤ í´ë¦­ì‹œ ì¥ì†Œëª… í‘œì¶œí•˜ëŠ” ì¸í¬ìœˆë„ìš°

        let infowindow = new kakao.maps.InfoWindow({zIndex: 1});

        // ì¥ì†Œ ê²€ìƒ‰ ê°ì²´ë¥¼ ìƒì„±
        var ps = new kakao.maps.services.Places();

        // ------------------------ í‚¤ì›Œë“œ ê²€ìƒ‰ ----------

        let markers = [];


        function searchPlaces() {
            // inputì— ë“¤ì–´ê°€ëŠ” í‚¤ì›Œë“œì˜ valueê°’ì´ keyword
            let keyword = document.getElementById('keyword').value;

            // keywordê°€ ê³µë°±ì´ë©´ alert ëœ¨ë„ë¡
//         if(!keyword.replace(/^\s+|\s+$/g,'')){
//             alert('í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
//             return false;
//             // ì˜ ì‘ë™ì¤‘
//         }

            // if(!keyword.replace(/^\s+|\s+$/g,'')){
            //     alert('í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
            //     return false;
            //     // ì˜ ì‘ë™ì¤‘
            // }

            ps.keywordSearch(keyword, placesSearchCB); // keyword = í•´ìš´ëŒ€ë§›ì§‘ => keywordSearch("í•´ìš´ëŒ€ë§›ì§‘",placeSearchCB);
            console.log("ps.keywordSearch ì‘ë™ì¤‘")
        }

        function addMarker(position, idx, title) {
            var imageSrc = 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_number_blue.png', // ë§ˆì»¤ ì´ë¯¸ì§€ url, ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ë¥¼ ì”ë‹ˆë‹¤
                imageSize = new kakao.maps.Size(36, 37),  // ë§ˆì»¤ ì´ë¯¸ì§€ì˜ í¬ê¸°
                imgOptions = {
                    spriteSize: new kakao.maps.Size(36, 691), // ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ì˜ í¬ê¸°
                    spriteOrigin: new kakao.maps.Point(0, (idx * 46) + 10), // ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ ì¤‘ ì‚¬ìš©í•  ì˜ì—­ì˜ ì¢Œìƒë‹¨ ì¢Œí‘œ
                    offset: new kakao.maps.Point(13, 37) // ë§ˆì»¤ ì¢Œí‘œì— ì¼ì¹˜ì‹œí‚¬ ì´ë¯¸ì§€ ë‚´ì—ì„œì˜ ì¢Œí‘œ
                },
                markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imgOptions),
                marker = new kakao.maps.Marker({
                    position: position, // ë§ˆì»¤ì˜ ìœ„ì¹˜
                    image: markerImage
                });
            console.log(marker);
            console.log("ê°€ê²Œì´ë¦„ì€" + title);
            displayInfowindow(marker, title);
            // ì§€ë„ ìœ„ì— ë§ˆì»¤ í‘œì¶œ
            marker.setMap(map);
            // ë°°ì—´ì— ìƒì„±ëœ ë§ˆì»¤ë¥¼ ì¶”ê°€í•œë‹¤.
            markers.push(marker);

            return marker;
        }


        // ì§€ë„ ìœ„ì— í‘œì‹œë˜ëŠ” ë§ˆì»¤ë¥¼ ëª¨ë‘ ì œê±°
        function removeMarker() {
            for (let i = 0; i < markers.length; i++) {
                markers[i].setMap(null);
            }
            markers = [];
        }

        // infowindowì— ì¥ì†Œëª…ì„ í‘œì‹œí•œë‹¤.
        function displayInfowindow(marker, title) {
            let content = '<div style="padding:5px;z-index:1;">' + title + '</div>';

            infowindow.setContent(content);
            infowindow.open(map, marker);
        }

        function removeAllchildNodes(el) {
            while (el.hasChildNodes()) {
                el.removeChild(el.lastChild);
            }
        }

        function displayPlaces(places) {
            let listEl = document.getElementById('placeList'),
                menuEl = document.getElementById('search_wrap'),
                fragment = document.createDocumentFragment(),
                bounds = new kakao.maps.LatLngBounds();
            let listStr = '';

            // ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡ì— ì¶”ê°€ëœ í•­ëª©ë“¤ì„ ì œê±°í•œë‹¤.
            removeAllchildNodes(listEl);

            // ì§€ë„ì— í‘œì‹œë˜ê³  ìˆëŠ” ë§ˆì»¤ë¥¼ ì œê±°í•œë‹¤.
            removeMarker();

            for (let i = 0; i < places.length; i++) {
                console.log(places[i]);

            }

            for (let i = 0; i < places.length; i++) {
                console.log(places[i]);
                let placePosition = new kakao.maps.LatLng(places[i].y, places[i].x),
                    marker = addMarker(placePosition, i, places[i].place_name),
                    itemEl = getListItem(i, places[i]); // ê²€ìƒ‰ ê²°ê³¼ í•­ëª© Elementë¥¼ ìƒì„±í•©ë‹ˆë‹¤

                bounds.extend(placePosition);

                console.log("ì—¬ê¸°ê¹Œì§€ ì˜¤ë‚˜");
                console.log(marker);
                (function () {
                    console.log("ìµëª…í•¨ìˆ˜ ì‹¤í–‰í•´ë³´ê¸°");
                })();

                (function (marker, title) {

                    // kakao.maps.event.addListener(marker, 'mouseover', function() {
                    //     displayInfowindow(marker, title);
                    // });
                    //
                    // kakao.maps.event.addListener(marker, 'mouseout', function() {
                    //     infowindow.close();
                    // });


                    itemEl.onmouseover = function () {
                        displayInfowindow(marker, title);
                        console.log(title);
                    };

                    itemEl.onmouseout = function () {
                        infowindow.close();
                    };
                })(marker, places[i].place_name);

                fragment.appendChild(itemEl);
                console.log("ë°˜ë³µë¬¸ ë„ëŠ”ì§€ í™•ì¸");
            }

            console.log(fragment);
            listEl.appendChild(fragment);
            console.log(listEl);
            menuEl.scrollTop = 0;
            // ê²€ìƒ‰ëœ ì¥ì†Œ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§€ë„ ë²”ìœ„ ì„¤ì •
            map.setBounds(bounds);
        }

        function displayPagination(pagination) {
            var paginationEl = document.getElementById('pagination'),
                fragment = document.createDocumentFragment(),
                i;

            // ê¸°ì¡´ì— ì¶”ê°€ëœ í˜ì´ì§€ë²ˆí˜¸ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤
            while (paginationEl.hasChildNodes()) {
                paginationEl.removeChild(paginationEl.lastChild);
            }

            for (i = 1; i <= pagination.last; i++) {
                var el = document.createElement('a');
                el.href = "#";
                el.innerHTML = i;

                if (i === pagination.current) {
                    el.className = 'on';
                } else {
                    el.onclick = (function (i) {
                        return function () {
                            pagination.gotoPage(i);
                        }
                    })(i);
                }

                fragment.appendChild(el);
            }
            paginationEl.appendChild(fragment);
        }

</script>

<!--ì¥ì†Œ ìƒì„¸ íŒì—…ì°½ ë ˆì´ì•„ì›ƒ html-->
<div id="detail_popup_layer">
    <div id="popup_box1">
        <!--íŒì—… ì»¨í…ì¸  ì˜ì—­-->
        <div id="popup_contents ">
            <th:block th:replace="popup/detailPopup"></th:block>
        </div>
    </div>
</div>
</body>
<script>

</script>
</html>
