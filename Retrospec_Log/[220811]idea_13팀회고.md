# [220811] idea_13íŒ€ íšŒê³ 


## íŒ€ êµ¬ì„±ì›

> [íŒ€ì¥] ê¶Œì¢…ì„, ê¹€ì•„ë¦„, ë°•ë‹¤ì •, ë°•ì¤‘í˜„, ë°•ì •ì›

## íšŒê³  ë‚´ìš© ìš”ì•½ (ìµœì†Œ 500ì ì´ìƒ)

## JPA

### JPA ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

dependencies ì¶”ê°€

```java
implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
```

<aside>
ğŸ’¡ implemetation
í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ë¥¼ ìœ„í•´ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì„¤ì •
í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë³€ê²½ë˜ë”ë¼ë„ ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ì—°ê´€ëœ ëª¨ë“  ëª¨ë“ˆë“¤ì„ ì»´íŒŒì¼í•˜ì§€ ì•Šê³  ì§ì ‘ ê´€ë ¨ì´ ìˆëŠ” ëª¨ë“ˆë“¤ë§Œ ì»´íŒŒì¼í•˜ê¸° ë•Œë¬¸ì— rebuild ì†ë„ê°€ ë¹ ë¦„

</aside>

### JPA ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì •

application.properties ìˆ˜ì •

```java
# JPA
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=update
```

- `spring.jpa.properties.hibernate.dialect` : ë°ì´í„°ë² ì´ìŠ¤ ì—”ì§„ ì¢…ë¥˜ ì„¤ì •
- `spring.jpa.hibernate.ddl-auto` : ì—”í‹°í‹°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” ê·œì¹™ì„ ì •ì˜

## ì—”í‹°í‹°

ì—”í‹°í‹° = DB í…Œì´ë¸”ê³¼ 1:1 ë§¤ì¹­

ì—”í‹°í‹° êµ¬ì„± êµ¬ìƒ í›„ í´ë˜ìŠ¤ ì¶”ê°€í•˜ì—¬ ì—”í‹°í‹° ì‘ì„±

- Question Entity

    ```java
    import java.time.LocalDateTime;
    
    import javax.persistence.Column;
    import javax.persistence.Entity;
    import javax.persistence.GeneratedValue;
    import javax.persistence.GenerationType;
    import javax.persistence.Id;
    
    import lombok.Getter;
    import lombok.Setter;
    
    @Getter
    @Setter
    @Entity
    public class Question {
        @Id
        @GeneratedValue(strategy = GenerationType.IDENTITY)
        private Integer id;
    
        @Column(length = 200)
        private String subject;
    
        @Column(columnDefinition = "TEXT")
        private String content;
    
        private LocalDateTime createDate;
    }
    ```


### ì—”í‹°í‹° ê´€ë ¨ ì–´ë…¸í…Œì´ì…˜

- `@Entity` ì–´ë…¸í…Œì´ì…˜ì„ ì ìš©í•´ì•¼ JPAê°€ ì—”í‹°í‹°ë¡œ ì¸ì‹
- **`@Id` :** ê³ ìœ  ë²ˆí˜¸ id ì†ì„±ì— ì ìš©í•œ @Id ì• ë„ˆí…Œì´ì…˜ì€ id ì†ì„±ì„ ê¸°ë³¸ í‚¤ë¡œ ì§€ì •
- **`@GeneratedValue` :** ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ í•´ë‹¹ ì†ì„±ì— ê°’ì„ ë”°ë¡œ ì„¸íŒ…í•˜ì§€ ì•Šì•„ë„ 1ì”© ìë™ìœ¼ë¡œ ì¦ê°€í•˜ì—¬ ì €ì¥
- **`@Column`**

  - ì»¬ëŸ¼ì˜ ì„¸ë¶€ ì„¤ì •ì„ ìœ„í•´ @Column ì• ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©

  - length : ëŠ” ì»¬ëŸ¼ì˜ ê¸¸ì´ë¥¼ ì„¤ì •

  - columnDefinition : ì»¬ëŸ¼ì˜ ì†ì„±ì„ ì •ì˜

  - columnDefinition = "TEXT" : "ë‚´ìš©"ì²˜ëŸ¼ ê¸€ì ìˆ˜ë¥¼ ì œí•œí•  ìˆ˜ ì—†ëŠ” ê²½ìš°ì— ì‚¬ìš©

- `@ManyToOne` : N:1 ê´€ê³„

## ë¦¬í¬ì§€í„°ë¦¬

### Repository ìƒì„±

1. QuestionRepository

```java
package com.ll.exam.sbb;

import org.springframework.data.jpa.repository.JpaRepository;

public interface QuestionRepository extends JpaRepository<Question, Integer> {

}
```

JpaRepositoryë¥¼ ìƒì†í•  ë•ŒëŠ” ì œë„¤ë¦­ìŠ¤ íƒ€ì…ìœ¼ë¡œ ë¦¬í¬ì§€í„°ë¦¬ì˜ ëŒ€ìƒì´ ë˜ëŠ” `ì—”í‹°í‹°ì˜ íƒ€ì…`(Question)ê³¼ í•´ë‹¹ `ì—”í‹°í‹°ì˜ PKì˜ ì†ì„± íƒ€ì…`(Integer)ì„ ì§€ì •

1. AnswerRepository

```java
package com.ll.exam.sbb;

import org.springframework.data.jpa.repository.JpaRepository;

public interface AnswerRepository extends JpaRepository<Answer, Integer> {

}
```

### ë°ì´í„° ì €ì¥í•˜ê¸°

í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±

```java
@Autowired
	private QuestionRepository questionRepository;

	@Test
	void contextLoads() {
	}

	@Test
	void testJpa() {
		Question q1 = new Question();
		q1.setSubject("sbbê°€ ë¬´ì—‡ì¸ê°€ìš”?");
		q1.setContent("sbbì— ëŒ€í•´ì„œ ì•Œê³  ì‹¶ìŠµë‹ˆë‹¤.");
		q1.setCreateDate(LocalDateTime.now());
		questionRepository.save(q1);  // ì²«ë²ˆì§¸ ì§ˆë¬¸ ì €ì¥

		Question q2 = new Question();
		q2.setSubject("ìŠ¤í”„ë§ë¶€íŠ¸ ëª¨ë¸ ì§ˆë¬¸ì…ë‹ˆë‹¤.");
		q2.setContent("idëŠ” ìë™ìœ¼ë¡œ ìƒì„±ë˜ë‚˜ìš”?");
		q2.setCreateDate(LocalDateTime.now());
		questionRepository.save(q2);  // ë‘ë²ˆì§¸ ì§ˆë¬¸ ì €ì¥
	}
```

- Questionê°ì²´ í•˜ë‚˜ = Questioní…Œì´ë¸”ì˜ í•˜ë‚˜ì˜ ë ˆì½”ë“œ
- í…ŒìŠ¤íŠ¸ Run ì´í›„ ë‹¤ì‹œ ë¡œì»¬ ì„œë²„ ì‹œì‘í•˜ì—¬ h2 ì½˜ì†” í™•ì¸í•˜ë©´ ì €ì¥í•œ ê°ì²´ ê°’ì´ DBì—

ì €ì¥ ëœ ê²ƒ í™•ì¸ ê°€ëŠ¥

- í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰ì‹œí‚¨ ë§Œí¼ ë°ì´í„°ê°€ ì¶”ê°€ë¨

### ë°ì´í„° ì¡°íšŒí•˜ê¸°

í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

- ë°ì´í„°ê°€ 2ê°œ ì¡´ì¬í•˜ê³  ìˆì„ ë•Œ ì§„í–‰í•´ì•¼ í•¨

- ë§Œì•½ ë°ì´í„° ì €ì¥ë‹¨ê³„ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì—¬ëŸ¬ ë²ˆ ì‹œí–‰í•´ ë‘ ê°œ ì´ìƒì˜ ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆë‹¤ë©´ drop table ì§„í–‰ í›„ ë°ì´í„° ì €ì¥ë¶€í„° ë‹¤ì‹œ ì‹œí–‰


1. **[`findBySubject`](https://github.com/jhs512/jump_to_sbb/commit/c96a16c1286b0d878ef1622731dcc6cc57b5c305)**

```java
@Test
void testJpa3() {
    // SELECT * FROM question
    Question q = questionRepository.findBySubject("sbbê°€ ë¬´ì—‡ì¸ê°€ìš”?");
    assertEquals(1, q.getId());
}
```

2. `findBySubjectAndContent`

```java
@Test
void testJpa4() {
    Question q = this.questionRepository.findBySubjectAndContent(
            "sbbê°€ ë¬´ì—‡ì¸ê°€ìš”?", "sbbì— ëŒ€í•´ì„œ ì•Œê³  ì‹¶ìŠµë‹ˆë‹¤.");
    assertEquals(1, q.getId());
}
```

3. `findBySubjectLike`

```java
@Test
void testJpa5() {
   List<Question> qList = this.questionRepository.findBySubjectLike("sbb%");
   Question q = qList.get(0);
   assertEquals("sbbê°€ ë¬´ì—‡ì¸ê°€ìš”?", q.getSubject());
}
```

í”„ë¡œì íŠ¸ì— í•„ìš”í•œ JPAê¸°ìˆ ì„ ìˆ˜ì—…ì‹œê°„ì— í•™ìŠµí•˜ë©´ì„œ ë¯¸ì²˜ ì´í•´í•˜ì§€ ëª»í–ˆë˜ ë¶€ë¶„ì— ëŒ€í•´ íŒ€ì›ë“¤ê³¼ íšŒê³ ë¥¼ ì§„í–‰í–ˆë‹¤.
íŠ¹íˆ JPAì—ì„œ Repositoryì— ë©”ì†Œë“œ ëª…ì„ í†µí•´ì„œ ìë™ìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ ì§œê³  ë°›ì•„ì˜¨ ë‹¤ëŠ” ì ì´ ì‹ ê¸°í–ˆë˜ ê²ƒ ê°™ë‹¤. 
findBy~í˜•íƒœë¡œ êµ¬ì„±ëœ ë©”ì†Œë“œëª…ë“¤ì„ ê°ê° í•™ìŠµí•˜ê³  ë°°ìš°ë©´ì„œ ìš°ë¦¬ì˜ í”„ë¡œì íŠ¸ì—ì„œëŠ” ì´ëŸ° ì‹ìœ¼ë¡œ ì ìš©í•˜ë©´ ì¢‹ê² ë‹¤ëŠ” í”¼ë“œë°±ì„ ì£¼ê³  ë°›ì•˜ë‹¤.


<br>

## íšŒê³  ê³¼ì •ì—ì„œ ë‚˜ì™”ë˜ ì§ˆë¬¸ (ìµœì†Œ 200ì ì´ìƒ)


gitëª…ë ¹ì–´ì— ê´€í•œ ì§ˆë¬¸ì´ ë‚˜ì™”ë‹¤. ë‹¤ë“¤ í˜‘ì—… ê²½í—˜ì´ ë§ì§„ ì•Šì•„ì„œ ê²½í—˜í•˜ê³ ì gitflow í˜‘ì—…ë°©ì‹ì„ ì‚¬ìš©í•˜ê¸°ë¡œ í–ˆëŠ”ë°, ë¸Œëœì¹˜ê°„ ì—°ê²°ê´€ê³„, ì»¤ë°‹ ë° pull, pull requestì˜ ë°©ë²•ì„ ì˜ ëª°ë¼ì„œ
ìˆ˜ì—…ì‹œê°„ì— ë°°ìš´ checkout, branch ì™¸ì—ë„ merge ë°©ì‹ì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ì—ˆë‹¤.
1. git branch -r
2. git checkout -t origin/development
3. git merge [ë¸Œëœì¹˜ëª…]
4. git remote update / git fetch [ë¸Œëœì¹˜ëª…]


  <br>

## íšŒê³  ì¸ì¦ìƒ· & íŒ€ ìë‘

![img.png](./img/0811.png)
