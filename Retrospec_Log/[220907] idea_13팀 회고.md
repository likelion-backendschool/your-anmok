# [220907] idea_13íŒ€ íšŒê³ 


## íŒ€ êµ¬ì„±ì›

> ê¶Œì¢…ì„, ê¹€ì•„ë¦„, ë°•ë‹¤ì •, ë°•ì¤‘í˜„, ë°•ì •ì›

## íšŒê³  ë‚´ìš© ìš”ì•½ (ìµœì†Œ 500ì ì´ìƒ)

## ì¸í”„ë¼

### Jar íŒŒì¼ì˜ ì¢…ë¥˜

> **Jar (Java ARchive)** : ìë°”ë¡œ ê°œë°œí•œ ê¸°ëŠ¥ ëª¨ë“ˆ, ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•œ í´ë˜ìŠ¤ íŒŒì¼, ì´ë¯¸ì§€ íŒŒì¼, ì†Œë¦¬ íŒŒì¼ ë“± ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ íŒŒì¼ì´ í¬í•¨
>
- executable jar

  ê·¸ ìì²´ë¡œ ì‹¤í–‰ ê°€ëŠ¥
  ì‹¤í–‰ì— í•„ìš”í•œ ê²ƒë“¤ì„ ì••ì¶•íŒŒì¼ ì•ˆì— ë§ì´ ë„£ì„ ìˆ˜ë¡, ì ì  ë” ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ ì‹¤í–‰ ê°€ëŠ¥

- lib jar

  ê·¸ ìì²´ë¡œ ì‹¤í–‰íŒŒì¼ì´ ì•„ë‹Œ ê²½ìš°ê°€ ë§ìŒ
  ë³´í†µ ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì— ì¢…ì†ë˜ì–´ ì‚¬ìš©ë¨
  libë“¤ì€ ì¢…ì†ì„± TREEë¡œ ë¬¶ì„

- war

  executable jarì˜ í•œ ì¢…ë¥˜ë¡œ í†°ìº£ì´ ë¹ ì ¸ìˆìŒ â†’ ì–´ì°¨í”¼ warëŠ” í†°ìº£ë‚´ë¶€ì— ì‚½ì…ë˜ê¸° ë•Œë¬¸
  ìŠ¤í”„ë§ ë¶€íŠ¸ì—ì„œëŠ” í”„ë¡œê·¸ë¨ ë°°í¬ ì‹œ jar, war 2ê°œì˜ ì„ íƒì§€ ì¡´ì¬


### í†°ìº£ êµ¬ì¡°ë„
![](img/0907_2.png)

- í†°ìº£ êµ¬ì„±ìš”ì†Œ
- í†°ìº£ : ì›¹ì•±ì„ íƒ‘ì¬í•  ìˆ˜ ìˆëŠ” ì»¨í…Œì´ë„ˆ, ì—¬ëŸ¬ê°œì˜ í˜¸ìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆê³ , ì„¤ì¹˜ ì§í›„ì—ëŠ” ê¸°ë³¸ í˜¸ìŠ¤íŠ¸ë§Œ ì¡´ì¬
- ê¸°ë³¸ í˜¸ìŠ¤íŠ¸ : ì„¤ì¹˜ ì§í›„ì—ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 5ê°œì˜ ì•±ì„ ê°€ì§€ê³  ìˆìŒ
- ë§¤ë‹ˆì €ì•± : ê° í˜¸ìŠ¤íŠ¸ë§ˆë‹¤ í•˜ë‚˜ì”© ì¡´ì¬, ìì‹ ì´ ì†í•œ í˜¸ìŠ¤íŠ¸ì—ì„œ ì†Œì†ëœ ë‹¤ë¥¸ ì•±ë“¤ì„ ê´€ë¦¬í•˜ëŠ”ë° ì‚¬ìš©, ì›ê²© ë°°í¬ì‹œì— ì‚¬ìš©
- í˜¸ìŠ¤íŠ¸ ë§¤ë‹ˆì €ì•± : í†°ìº£ë‹¹ 1ê°œì”© ì¡´ì¬, í˜¸ìŠ¤íŠ¸ë¥¼ ì¶”ê°€, ì‚­ì œí•  ìˆ˜ ìˆìŒ
- docsì•± : í†°ìº£ ê³µì‹ ë¬¸ì„œê°€ ë‹´ê²¨ìˆëŠ” ì•±
- examplesì•± : í†°ìº£ ì˜ˆì œ ì†ŒìŠ¤ì½”ë“œê°€ ë‹´ê²¨ìˆëŠ” ì•±
- ì•±ì˜ URL êµ¬ì„± : í˜¸ìŠ¤íŠ¸/ì•± ì´ë¦„
- ë£¨íŠ¸ì•±: í˜¸ìŠ¤íŠ¸ëª…ë§Œìœ¼ë¡œ êµ¬ì„±ëœ URLë¡œ ì ‘ì†í–ˆì„ ë•Œ ë‚˜ì˜¤ëŠ” ì•±
- ë³´í†µ í†°ìº£ì— ìƒˆë¡œìš´ ì‚¬ì´íŠ¸ë¥¼ ì¶”ê°€í•  ë•Œ, í˜¸ìŠ¤íŠ¸ë§¤ë‹ˆì €ë¡œ í˜¸ìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•œ í›„, í•´ë‹¹ í˜¸ìŠ¤íŠ¸ì•ˆì— ë£¨íŠ¸ì•±ë§Œ ì¶”ê°€
- ë³‘ë ¬ë°°í¬ â†’ ë²„ì „ì„ ë‹¬ë¦¬í•˜ë©´ ë˜‘ê°™ì€ ì•±ì´ í•˜ë‚˜ì˜ í˜¸ìŠ¤íŠ¸ ë‚´ì— ì—¬ëŸ¬ê°œ ì¡´ì¬ ê°€ëŠ¥ â†’ ì‚¬ìš©ìê°€ ì ‘ê·¼í–ˆì„ ë•Œ í†°ìº£ì´ ë²„ì „ì´ ë†’ì€ ì•± ë…¸ì¶œ

## ìŠ¤í”„ë§ë¶€íŠ¸

### ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ë¡œê·¸ì¸

- UserDetails
  : ì‹œíë¦¬í‹°ê°€ /login ì£¼ì†Œ ìš”ì²­ì´ ì˜¤ë©´ ë‚šì•„ì±„ì„œ ë¡œê·¸ì¸ì„ ì§„í–‰í•˜ëŠ”ë° ë¡œê·¸ì¸ ì§„í–‰ì´ ì™„ë£Œë˜ë©´ ì‹œíë¦¬í‹° ì„¸ì…˜ì„ ë§Œë“¤ì–´ì¤Œ. ì„¸ì…˜ì˜ í‚¤ ê°’ì€ Security ContextHolderì´ê³  ê°’ì€ Authentication íƒ€ì…ì˜ ê°ì²´ì…ë‹ˆë‹¤. Authentication íƒ€ì… ê°ì²´ì—ëŠ” User ì •ë³´ê°€ ë‹´ê²¨ ìˆì–´ì•¼ í•˜ëŠ”ë° ê·¸ Userì •ë³´ëŠ” UserDetails íƒ€ì… ê°ì²´ì— ë‹´ê²¨ ìˆìŒ. 

  - UserDetails : ì‹œíë¦¬í‹°ì—ì„œ ì œê³µí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤.
  - getAuthorities() : Userì˜ ê¶Œí•œì„ ë¦¬í„´ì„ í•©ë‹ˆë‹¤.
  - getPassword() : Userì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë¦¬í„´ì„ í•©ë‹ˆë‹¤.
  - getUsername() : Userì˜ ì•„ì´ë””ë¥¼ ë¦¬í„´ì„ í•©ë‹ˆë‹¤.
  - isAccountNonExpired() : ê³„ì •ì´ ë§Œë£Œë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.
  - isAccountNonLocked() : ê³„ì •ì´ ì ê²¼ëŠ”ì§€ ì—¬ë¶€ë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.
  - isCredentialsNonExpired() : ê³„ì •ì˜ ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¤ë˜ ì‚¬ìš©í–ˆëŠ”ì§€ì— ëŒ€í•œ ì—¬ë¶€ë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.
  - isEnabled() : ê³„ì •ì˜ í™œì„±í™” ì—¬ë¶€ë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.
  
- UserDetailsService
: ì‹œíë¦¬í‹° ì„¤ì •ì—ì„œ loginProcessingUrl("/login")ìœ¼ë¡œ ìš”ì²­ì´ ì˜¤ë©´ ìë™ìœ¼ë¡œ UserDetailsService íƒ€ì…ìœ¼ë¡œ Iocê°€ ë˜ì–´ìˆëŠ” loadUserByUsernameí•¨ìˆ˜ê°€ ì‹¤í–‰ë¨.
  
  - loadUserByUsernameì˜ í•¨ìˆ˜ì—ì„œ ë§¤ê°œ ë³€ìˆ˜ì¸ usernameì€ htmlì¼ ê²½ìš° name=â€usernameâ€ê³¼ ë™ì¼í•´ì•¼í•¨
  
- BCryptPasswordEncoder
: ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•”í˜¸í™”, controllerì— ë¹ˆìœ¼ë¡œ ë“±ë¡ëœ BCryptPasswordEncoderë¥¼ ìë™ìœ¼ë¡œ ì£¼ì…


#### ì‹œíë¦¬í‹° ì„¤ì •

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {

    @Bean
    public BCryptPasswordEncoder encodePwd() {
        return new BCryptPasswordEncoder();
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.csrf().disable();
        http.authorizeRequests()
                .antMatchers("/user/**").authenticated()
                .antMatchers("/manager/**").access("hasRole('ROLE_ADMIN') or hasRole('ROLE_MANAGER')")
                .antMatchers("/admin/**").access("hasRole('ROLE_ADMIN')")
                .anyRequest().permitAll()
                .and()
                .formLogin()
                .loginPage("/loginForm")
                .loginProcessingUrl("/login") 
                .defaultSuccessUrl("/");
               
    }
}
```

#### ì‚¬ìš©ì ì¸ì¦

```java
public class PrincipalDetails implements UserDetails {
    private User user;

    public PrincipalDetails(User user) {
        this.user = user;
    }

    @Override
    public Collection<? extends GrantedAuthority> getAuthorities() {
        Collection<GrantedAuthority> collection = new ArrayList<>();
        collection.add(new GrantedAuthority() {
            @Override
            public String getAuthority() {
                return user.getRole();
            }
        });
        return collection;
    }

    @Override
    public String getPassword() {
        return user.getPassword();
    }

    @Override
    public String getUsername() {
        return user.getUsername();
    }

    @Override
    public boolean isAccountNonExpired() {
        return true;
    }

    @Override
    public boolean isAccountNonLocked() {
        return true;
    }

    @Override
    public boolean isCredentialsNonExpired() {
        return true;
    }

    @Override
    public boolean isEnabled() {
        return true;
    }
}
```

```java
@Service
public class PrincipallDetailsService implements UserDetailsService {
    @Autowired
    private UserRepository userRepository;

    @Override
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
        User user = userRepository.findByUsername(username);
        if(user != null) {
            return new PrincipalDetails(user);
        }
        return null;
    }
}
```



## íšŒê³  ê³¼ì •ì—ì„œ ë‚˜ì™”ë˜ ì§ˆë¬¸ (ìµœì†Œ 200ì ì´ìƒ)
Q. JARì™€ WARì˜ ì°¨ì´ì <br>
```text
ğŸ’¡ JAR
- Classì™€ ê°™ì€ JAVA ë¦¬ì†ŒìŠ¤ì™€ ì†ì„± íŒŒì¼, ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì•¡ì„¸ì„œë¦¬ íŒŒì¼ì´ í¬í•¨
- JAVA ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë™ì‘í•  ìˆ˜ ìˆë„ë¡ ìë°” í”„ë¡œì íŠ¸ë¥¼ ì••ì¶•í•œ íŒŒì¼

ğŸ’¡ WAR
- ì›¹ ê´€ë ¨ ìì›ë§Œ í¬í•¨í•˜ê³  ìˆìœ¼ë©° ì´ë¥¼ ì‚¬ìš©í•˜ë©´ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‰½ê²Œ ë°°í¬í•˜ê³  í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
```
- WAR íŒŒì¼ë„ JAVAì˜ JAR ì˜µì…˜(java -jar)ì„ ì´ìš©í•´ ìƒì„±í•˜ëŠ” JAR íŒŒì¼ì˜ ì¼ì¢…ìœ¼ë¡œ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ë¥¼ íŒ¨í‚¤ì§•í•˜ê¸° ìœ„í•œ JAR íŒŒì¼ì´ë‹¤.

## íšŒê³  ì¸ì¦ìƒ· & íŒ€ ìë‘
![](img/0907_1.png)
